```markdown
# 4 Security Architecture

## 4.1 Goals
- Maintain confidentiality, integrity, authenticity.
- Provide secure multi-application coexistence.

## 4.2 Security Responsibilities and Requirements

### 4.2.1 Card Issuer
Initializes card keys and enforces personalization policy.

### 4.2.2 Application Provider
Signs applications with DAP; protects its keys.

### 4.2.3 Controlling Authority
Approves and enforces cross-domain security.

### 4.2.4 On-Card Components
Ensure command authentication and access control.

### 4.2.5 Back-End Systems
Protect secure key storage and transport.

## 4.3 Cryptographic Support

### 4.3.1 Secure Card Content Management
All content operations occur over SCP-protected channels.

### 4.3.2 Secure Communication
Uses message MAC/ENC for integrity and confidentiality.

<!-- Figure 4-2: SCP Key Derivation and Usage -->
```mermaid
graph LR
  BaseKey[ISD Base Key] -->|Derive| SessionKeys[SCP03 Session Keys (S-ENC, S-MAC, DEK)]
  SessionKeys -->|Protect| APDU[Secure Messaging]
<!-- Table 4-1: Key Types and Usage --> <!-- presenter note: Explain key derivation hierarchy and SCP03 session management. -->
php-template
Copy code

---